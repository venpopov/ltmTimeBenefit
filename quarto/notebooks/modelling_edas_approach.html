<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.37">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Free time &amp; chunking modeling – Main results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../quarto/notebooks/par_identifiability.html" rel="next">
<link href="../../quarto/notebooks/subject_data.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link rel="stylesheet" href="../../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Free time &amp; chunking modeling</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/venpopov/ltmTimeBenefit">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/venpopov/ltmTimeBenefit/issues">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Notebooks</li><li class="breadcrumb-item"><a href="../../quarto/notebooks/modelling_edas_approach.html">Model 1: Original model</a></li><li class="breadcrumb-item"><a href="../../quarto/notebooks/modelling_edas_approach.html">Main results</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Development notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/dev-notebooks/2021-05-16-meeting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2021-05-16 Meeting Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/dev-notebooks/model_sqrt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model with sqrt scaled strength</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/dev-notebooks/playground.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Playground 1: Optim stuff</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Notebooks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/data_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">View the data structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploratory data analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/subject_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subject-level data</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Model 1: Original model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/modelling_edas_approach.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Main results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/par_identifiability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parameter identifiability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/sensitivity-to-tau.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sensitivity to tau</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/exp3_model1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experiment 3</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Model 2: Include encoding time</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/model_v2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Main results</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/model-explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploring model predictions</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Model 3: Non-linear recovery</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/non_linear_recovery.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explore model predictions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/notebooks/model3_basic_fits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic fits</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Function reference</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/aggregate_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aggregate Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/calcdev.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculate the deviance of a model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/extract_object_from_rdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get data object from a file</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/get_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">get_data function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/inv_logit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inverse Logit Transformation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/logit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logit Transformation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/overall_deviance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculate the overall deviance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/preprocess_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preprocesses the data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/reference/serial_recall.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Serial Recall Model</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li>
<a href="#ignoring-first-chunk-in-the-optimiziation" id="toc-ignoring-first-chunk-in-the-optimiziation" class="nav-link" data-scroll-target="#ignoring-first-chunk-in-the-optimiziation">Ignoring first chunk in the optimiziation</a>
  <ul class="collapse">
<li><a href="#basic-estimation-of-exp1" id="toc-basic-estimation-of-exp1" class="nav-link" data-scroll-target="#basic-estimation-of-exp1">Basic estimation of Exp1</a></li>
  <li><a href="#trying-different-starting-values" id="toc-trying-different-starting-values" class="nav-link" data-scroll-target="#trying-different-starting-values">Trying different starting values</a></li>
  <li><a href="#trying-priors-of-the-gain-parameter" id="toc-trying-priors-of-the-gain-parameter" class="nav-link" data-scroll-target="#trying-priors-of-the-gain-parameter">Trying priors of the gain parameter</a></li>
  <li><a href="#trying-priors-on-the-rate-parameter" id="toc-trying-priors-on-the-rate-parameter" class="nav-link" data-scroll-target="#trying-priors-on-the-rate-parameter">Trying priors on the rate parameter</a></li>
  </ul>
</li>
  <li>
<a href="#including-the-first-chunk-in-the-optimization" id="toc-including-the-first-chunk-in-the-optimization" class="nav-link" data-scroll-target="#including-the-first-chunk-in-the-optimization">Including the first chunk in the optimization</a>
  <ul class="collapse">
<li><a href="#with-prior-on-rate" id="toc-with-prior-on-rate" class="nav-link" data-scroll-target="#with-prior-on-rate">With prior on rate</a></li>
  </ul>
</li>
  <li>
<a href="#repeat-for-expereiment-2" id="toc-repeat-for-expereiment-2" class="nav-link" data-scroll-target="#repeat-for-expereiment-2">Repeat for expereiment 2</a>
  <ul class="collapse">
<li><a href="#problem-with-parameter-identifiability" id="toc-problem-with-parameter-identifiability" class="nav-link" data-scroll-target="#problem-with-parameter-identifiability">Problem with parameter identifiability</a></li>
  <li><a href="#with-prior-on-gain" id="toc-with-prior-on-gain" class="nav-link" data-scroll-target="#with-prior-on-gain">With prior on gain</a></li>
  <li><a href="#with-prior-on-rate-1" id="toc-with-prior-on-rate-1" class="nav-link" data-scroll-target="#with-prior-on-rate-1">with prior on rate</a></li>
  <li><a href="#including-the-first-chunk-in-the-optimization-1" id="toc-including-the-first-chunk-in-the-optimization-1" class="nav-link" data-scroll-target="#including-the-first-chunk-in-the-optimization-1">Including the first chunk in the optimization</a></li>
  <li><a href="#with-prior-on-rate-2" id="toc-with-prior-on-rate-2" class="nav-link" data-scroll-target="#with-prior-on-rate-2">With prior on rate</a></li>
  </ul>
</li>
  <li>
<a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
<li><a href="#best-fitting-parameters" id="toc-best-fitting-parameters" class="nav-link" data-scroll-target="#best-fitting-parameters">Best fitting parameters</a></li>
  <li><a href="#predictions" id="toc-predictions" class="nav-link" data-scroll-target="#predictions">Predictions</a></li>
  <li><a href="#all-predictions" id="toc-all-predictions" class="nav-link" data-scroll-target="#all-predictions">All predictions</a></li>
  <li><a href="#experiment-1" id="toc-experiment-1" class="nav-link" data-scroll-target="#experiment-1">Experiment 1</a></li>
  <li><a href="#experiment-2" id="toc-experiment-2" class="nav-link" data-scroll-target="#experiment-2">Experiment 2</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Notebooks</li><li class="breadcrumb-item"><a href="../../quarto/notebooks/modelling_edas_approach.html">Model 1: Original model</a></li><li class="breadcrumb-item"><a href="../../quarto/notebooks/modelling_edas_approach.html">Main results</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Main results</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/">targets</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="co"># load "R/*" scripts and saved R objects from the targets pi</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_source.html">tar_source</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">exp1_data</span>, <span class="va">exp2_data</span>, <span class="va">exp1_data_agg</span>, <span class="va">exp2_data_agg</span>, <span class="va">fits1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>Here I apply the model described in the May 13th draft of the paper to the data. I will first ignore the first chunk in the optimization, then include it. I will also try different priors on the parameters to understand the paramater space. Final results from different choices summarized at the end.</p>
</section><section id="ignoring-first-chunk-in-the-optimiziation" class="level2"><h2 class="anchored" data-anchor-id="ignoring-first-chunk-in-the-optimiziation">Ignoring first chunk in the optimiziation</h2>
<section id="basic-estimation-of-exp1" class="level3"><h3 class="anchored" data-anchor-id="basic-estimation-of-exp1">Basic estimation of Exp1</h3>
<p>Let’s apply the modeling approach reported in the paper. We ignore the first chunk (SP1-3) while evaluating the likelihood. Eda did this because the model as implemented predicts the same performance for known and random chunks.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">exp1_data_agg</span><span class="op">)</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu">paper_params</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">estimate_model</span><span class="op">(</span><span class="va">start</span>, data <span class="op">=</span> <span class="va">exp1_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$start
    prop prop_ltm      tau     gain     rate 
    0.21     0.55     0.14    25.00     0.02 

$par
        prop     prop_ltm          tau         gain         rate 
 0.108898668  0.575632670  0.091783835 95.188660503  0.009362919 

$convergence
[1] 0

$counts
function gradient 
    2080       NA 

$value
[1] 31.92645</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp1_data_agg</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">est</span>, <span class="va">exp1_data_agg</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exp1_data_agg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/model 1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I get startlingly different paramemter estimates. Much lower <code>prop</code> and <code>rate</code> and <code>tau</code>, higher <code>gain</code>.</p>
</section><section id="trying-different-starting-values" class="level3"><h3 class="anchored" data-anchor-id="trying-different-starting-values">Trying different starting values</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># load the fits of the first simulation, calculate the deviance(s) and predictions</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">fits1</span><span class="op">)</span></span>
<span><span class="va">fits1</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    deviance <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html">pmap_dbl</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="va">exclude_sp1</span><span class="op">)</span>,</span>
<span>      <span class="op">~</span> <span class="fu">overall_deviance</span><span class="op">(</span>params <span class="op">=</span> <span class="va">`..1`</span><span class="op">$</span><span class="va">par</span>, data <span class="op">=</span> <span class="va">`..2`</span>, exclude_sp1 <span class="op">=</span> <span class="va">`..3`</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    pred <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">.y</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I’ve run this with many different starting values. We tend to end up in different regions of the parameter space (the top result close to the paper’s estimates):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">deviance</span> <span class="op">&lt;=</span> <span class="fl">50</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">gain</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 7
    prop prop_ltm  rate   tau  gain deviance convergence
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
 1 0.176    0.582 0.015 0.133  38.2     32.4           0
 2 0.175    0.578 0.015 0.132  38.8     32.4           0
 3 0.171    0.582 0.015 0.13   40.3     32.4           0
 4 0.165    0.581 0.014 0.127  43.1     32.3           0
 5 0.137    0.578 0.012 0.11   61.8     32.1           0
 6 0.126    0.577 0.011 0.103  71.8     32.0           0
 7 0.125    0.577 0.011 0.103  72.6     32.0           0
 8 0.123    0.577 0.011 0.101  75.2     32.0           0
 9 0.118    0.576 0.01  0.098  81.8     32.0           0
10 0.118    0.577 0.01  0.098  82.0     32.0           0
11 0.117    0.576 0.01  0.097  83.3     32.0           0
12 0.106    0.575 0.009 0.09   99.4     31.9           0
13 0.106    0.575 0.009 0.09   99.6     31.9           0
14 0.106    0.576 0.009 0.09   99.7     31.9           0
15 0.106    0.575 0.009 0.09   99.8     31.9           0
16 0.106    0.576 0.009 0.09   99.8     31.9           0
17 0.106    0.576 0.009 0.09   99.9     31.9           0
18 0.106    0.575 0.009 0.09   99.9     31.9           0
19 0.106    0.576 0.009 0.09   99.9     31.9           0
20 0.106    0.575 0.009 0.09   99.9     31.9           0
21 0.106    0.575 0.009 0.09   99.9     31.9           0
22 0.106    0.575 0.009 0.09  100.      31.9           0
23 0.106    0.576 0.009 0.09  100.      31.9           0
24 0.106    0.576 0.009 0.09  100.      31.9           0
25 0.106    0.576 0.009 0.09  100.      31.9           0
26 0.106    0.576 0.009 0.09  100.      31.9           0
27 0.106    0.576 0.009 0.09  100.      31.9           0
28 0.106    0.577 0.009 0.09  100.      31.9           0
29 0.106    0.575 0.009 0.09  100.      31.9           0
30 0.106    0.576 0.009 0.09  100.      31.9           0
31 0.106    0.574 0.009 0.09  100.      31.9           0
32 0.106    0.575 0.009 0.09  100.      31.9           0
33 0.106    0.576 0.009 0.09  100.      31.9           0
34 0.106    0.575 0.009 0.09  100.      31.9           0
35 0.106    0.575 0.009 0.09  100.      31.9           0
36 0.106    0.576 0.009 0.09  100.      31.9           0
37 0.106    0.574 0.009 0.09  100.      31.9           0
38 0.106    0.576 0.009 0.09  100.      31.9           0
39 0.106    0.576 0.009 0.09  100.      31.9           0
40 0.106    0.575 0.009 0.09  100.      31.9           0
41 0.106    0.576 0.009 0.09  100.      31.9           0
42 0.106    0.575 0.009 0.09  100.      31.9           0
43 0.106    0.575 0.009 0.09  100.      31.9           0
44 0.106    0.574 0.009 0.09  100.      31.9           0
45 0.106    0.576 0.009 0.09  100.      31.9           0
46 0.106    0.576 0.009 0.09  100.      31.9           0
47 0.106    0.575 0.009 0.09  100       31.9           0
48 0.106    0.575 0.009 0.09  100       31.9           0
49 0.106    0.575 0.009 0.09  100       31.9           0
50 0.106    0.575 0.009 0.09  100       31.9           0
51 0.106    0.576 0.009 0.09  100       31.9           0
52 0.106    0.576 0.009 0.09  100       31.9           0
53 0.106    0.576 0.009 0.09  100       31.9           0
54 0.106    0.575 0.009 0.09  100       31.9           0
55 0.106    0.571 0.009 0.09  100       31.9           0</code></pre>
</div>
</div>
</section><section id="trying-priors-of-the-gain-parameter" class="level3"><h3 class="anchored" data-anchor-id="trying-priors-of-the-gain-parameter">Trying priors of the gain parameter</h3>
<p>One way to deal with that is to put a prior on the gain parameter to keep it near 25. I know priors are usually a bayesian thing, but they work with ML optimization just as well. On the next set of simulations, I used a Normal(25, 0.1) prior on the gain parameter (could have also fixed it to this value, but this gives me mroe control).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"gain"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">deviance</span> <span class="op">&lt;=</span> <span class="fl">50</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">gain</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 23 × 7
    prop prop_ltm  rate   tau  gain deviance convergence
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
 1 0.222    0.587 0.019 0.154  25.0     33.0           0
 2 0.222    0.588 0.018 0.154  25.0     33.0           0
 3 0.222    0.588 0.019 0.154  25       33.0           0
 4 0.222    0.588 0.019 0.154  25       33.0           0
 5 0.222    0.588 0.019 0.154  25       33.0           0
 6 0.222    0.588 0.019 0.154  25       33.0           0
 7 0.222    0.588 0.019 0.154  25       33.0           0
 8 0.222    0.588 0.019 0.154  25       33.0           0
 9 0.222    0.588 0.019 0.154  25.0     33.0           0
10 0.222    0.588 0.019 0.154  25.0     33.0           0
11 0.222    0.588 0.019 0.154  25.0     33.0           0
12 0.222    0.588 0.019 0.154  25.0     33.0           0
13 0.222    0.588 0.019 0.154  25.0     33.0           0
14 0.208    0.398 0.031 0.154  25.0     47.7           0
15 0.222    0.587 0.019 0.154  25.0     33.0           0
16 0.222    0.587 0.019 0.154  25.0     33.0           0
17 0.222    0.587 0.019 0.154  25.0     33.0           0
18 0.222    0.588 0.019 0.154  25.0     33.0           0
19 0.222    0.588 0.019 0.154  25.0     33.0           0
20 0.222    0.588 0.019 0.154  25.0     33.0           0
21 0.222    0.588 0.019 0.154  25.0     33.0           0
22 0.222    0.588 0.019 0.154  25.0     33.0           0
23 0.222    0.588 0.019 0.154  25.0     33.0           0</code></pre>
</div>
</div>
<p>So we do get at least some parameters that are close to that reported in the paper. The predictions with those parameters:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp1_data_agg</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"gain"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">"pred"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exp1_data_agg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="trying-priors-on-the-rate-parameter" class="level3"><h3 class="anchored" data-anchor-id="trying-priors-on-the-rate-parameter">Trying priors on the rate parameter</h3>
<p>Maybe there is a region with a higher rate that we have not explored? Let’s try a prior on the rate parameter, ~ Normal(0.1, 0.01).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"rate"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 7
     prop prop_ltm  rate   tau  gain deviance convergence
    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
  1 0.435    0.608 0.049 0.202  7.59     43.1           0
  2 0.434    0.607 0.049 0.202  7.60     43.1           0
  3 0.435    0.607 0.049 0.202  7.59     43.1           0
  4 0.435    0.608 0.049 0.202  7.59     43.1           0
  5 0.435    0.607 0.049 0.202  7.59     43.1           0
  6 0.435    0.608 0.049 0.202  7.59     43.1           0
  7 0.434    0.607 0.049 0.202  7.59     43.1           0
  8 0.435    0.607 0.049 0.202  7.58     43.1           0
  9 0.435    0.607 0.049 0.202  7.59     43.1           0
 10 0.435    0.607 0.049 0.202  7.59     43.1           0
 11 0.435    0.608 0.049 0.202  7.59     43.1           0
 12 0.435    0.607 0.049 0.202  7.59     43.1           0
 13 0.435    0.607 0.049 0.202  7.58     43.1           0
 14 0.435    0.607 0.049 0.202  7.59     43.1           0
 15 0.435    0.607 0.049 0.202  7.59     43.1           0
 16 0.435    0.607 0.049 0.202  7.58     43.1           0
 17 0.435    0.607 0.049 0.202  7.58     43.1           0
 18 0.435    0.607 0.049 0.202  7.59     43.1           0
 19 0.435    0.607 0.049 0.202  7.59     43.1           0
 20 0.435    0.607 0.049 0.202  7.59     43.1           0
 21 0.435    0.607 0.049 0.202  7.58     43.1           0
 22 0.435    0.608 0.049 0.202  7.59     43.1           0
 23 0.435    0.607 0.049 0.202  7.58     43.1           0
 24 0.435    0.607 0.049 0.202  7.58     43.1           0
 25 0.435    0.607 0.049 0.202  7.59     43.1           0
 26 0.435    0.607 0.049 0.202  7.59     43.1           0
 27 0.435    0.607 0.049 0.202  7.58     43.1           0
 28 0.435    0.607 0.049 0.202  7.58     43.1           0
 29 0.435    0.607 0.049 0.202  7.58     43.1           0
 30 0.435    0.607 0.049 0.202  7.58     43.1           0
 31 0.435    0.607 0.049 0.202  7.59     43.1           0
 32 0.435    0.607 0.049 0.202  7.58     43.1           0
 33 0.435    0.607 0.049 0.202  7.58     43.1           0
 34 0.435    0.607 0.049 0.202  7.58     43.1           0
 35 0.435    0.607 0.049 0.202  7.58     43.1           0
 36 0.435    0.607 0.049 0.202  7.58     43.1           0
 37 0.435    0.607 0.049 0.202  7.59     43.1           0
 38 0.435    0.607 0.049 0.202  7.59     43.1           0
 39 0.435    0.607 0.049 0.202  7.58     43.1           0
 40 0.435    0.607 0.049 0.202  7.58     43.1           0
 41 0.435    0.607 0.049 0.202  7.58     43.1           0
 42 0.435    0.607 0.049 0.202  7.59     43.1           0
 43 0.435    0.607 0.049 0.202  7.58     43.1           0
 44 0.435    0.607 0.049 0.202  7.59     43.1           0
 45 0.435    0.607 0.049 0.202  7.58     43.1           0
 46 0.435    0.607 0.049 0.202  7.59     43.1           0
 47 0.435    0.607 0.049 0.202  7.58     43.1           0
 48 0.435    0.608 0.049 0.202  7.58     43.1           0
 49 0.435    0.607 0.049 0.202  7.58     43.1           0
 50 0.435    0.608 0.049 0.202  7.58     43.1           0
 51 0.435    0.607 0.049 0.202  7.58     43.1           0
 52 0.435    0.607 0.049 0.202  7.59     43.1           0
 53 0.435    0.607 0.049 0.202  7.58     43.1           0
 54 0.435    0.607 0.049 0.202  7.59     43.1           0
 55 0.435    0.607 0.049 0.202  7.58     43.1           0
 56 0.435    0.607 0.049 0.202  7.58     43.1           0
 57 0.435    0.607 0.049 0.202  7.58     43.1           0
 58 0.435    0.607 0.049 0.202  7.58     43.1           0
 59 0.435    0.607 0.049 0.202  7.58     43.1           0
 60 0.435    0.607 0.049 0.202  7.58     43.1           0
 61 0.435    0.607 0.049 0.202  7.58     43.1           0
 62 0.435    0.607 0.049 0.202  7.58     43.1           0
 63 0.435    0.608 0.049 0.202  7.59     43.1           0
 64 0.435    0.608 0.049 0.202  7.58     43.1           0
 65 0.435    0.607 0.049 0.202  7.58     43.1           0
 66 0.435    0.607 0.049 0.202  7.58     43.1           0
 67 0.435    0.607 0.049 0.202  7.58     43.1           0
 68 0.435    0.607 0.049 0.202  7.58     43.1           0
 69 0.435    0.607 0.049 0.202  7.58     43.1           0
 70 0.435    0.607 0.049 0.202  7.58     43.1           0
 71 0.435    0.607 0.049 0.202  7.58     43.2           0
 72 0.435    0.608 0.049 0.202  7.58     43.2           0
 73 0.435    0.607 0.049 0.202  7.58     43.2           0
 74 0.435    0.607 0.049 0.202  7.58     43.2           0
 75 0.435    0.607 0.049 0.202  7.58     43.2           0
 76 0.435    0.608 0.049 0.202  7.58     43.2           0
 77 0.435    0.608 0.049 0.202  7.58     43.2           0
 78 0.435    0.607 0.049 0.202  7.58     43.2           0
 79 0.435    0.608 0.049 0.202  7.57     43.2           0
 80 0.435    0.607 0.049 0.202  7.57     43.2           0
 81 0.39     0.375 0.071 0.218  7.90     55.8           0
 82 0.39     0.375 0.071 0.218  7.88     55.8           0
 83 0.39     0.375 0.071 0.218  7.88     55.8           0
 84 0.39     0.375 0.071 0.218  7.88     55.8           0
 85 0.39     0.375 0.071 0.218  7.87     55.8           0
 86 0.39     0.375 0.071 0.218  7.88     55.8           0
 87 0.39     0.375 0.071 0.218  7.88     55.8           0
 88 0.39     0.375 0.071 0.218  7.87     55.8           0
 89 0.39     0.375 0.071 0.218  7.87     55.8           0
 90 0.39     0.375 0.071 0.218  7.88     55.8           0
 91 0.39     0.375 0.071 0.218  7.87     55.8           0
 92 0.39     0.375 0.071 0.218  7.87     55.8           0
 93 0.39     0.375 0.071 0.218  7.87     55.8           0
 94 0.39     0.375 0.071 0.218  7.87     55.8           0
 95 0.39     0.375 0.071 0.218  7.88     55.8           0
 96 0.39     0.375 0.071 0.218  7.87     55.8           0
 97 0.39     0.375 0.071 0.218  7.87     55.8           0
 98 0.391    0.375 0.071 0.218  7.86     55.8           0
 99 0.39     0.375 0.071 0.218  7.87     55.8           0
100 0.386    0.017 0.081 0.226  7.39     75.0           0</code></pre>
</div>
</div>
<p>Deviance is quite much higher. Predictions?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"rate"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">"fit"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span><span class="op">$</span><span class="va">par</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      prop   prop_ltm       rate        tau       gain 
0.43456497 0.60758909 0.04906632 0.20157962 7.58996852 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp1_data_agg</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">exp1_data_agg</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exp1_data_agg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Geater mismatch. Let’s include error bars of the data:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp1_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">chunk</span>, <span class="va">gap</span>, <span class="va">itemtype</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    n_total <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    n_correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cor</span><span class="op">)</span>,</span>
<span>    p_correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cor</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">exp1_data_agg</span>, <span class="va">chunk</span>, <span class="va">gap</span>, <span class="va">itemtype</span>, <span class="va">pred</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span>, <span class="st">"itemtype"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, geom <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'id', 'chunk', 'gap'. You can override using the `.groups` argument.
No summary function supplied, defaulting to `mean_se()`
No summary function supplied, defaulting to `mean_se()`
No summary function supplied, defaulting to `mean_se()`
No summary function supplied, defaulting to `mean_se()`
No summary function supplied, defaulting to `mean_se()`
No summary function supplied, defaulting to `mean_se()`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Paraneters seem consistent with the data (see <a href="../../quarto/notes.html">my notes</a>).</p>
</section></section><section id="including-the-first-chunk-in-the-optimization" class="level2"><h2 class="anchored" data-anchor-id="including-the-first-chunk-in-the-optimization">Including the first chunk in the optimization</h2>
<p>The reports above followed the approach in the current draft and excluded the first chunk from the calculation of the likelihood when optimizing the parameters. Let’s include it:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu">paper_params</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">estimate_model</span><span class="op">(</span><span class="va">start</span>, data <span class="op">=</span> <span class="va">exp1_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$start
    prop prop_ltm      tau     gain     rate 
    0.21     0.55     0.14    25.00     0.02 

$par
       prop    prop_ltm         tau        gain        rate 
 0.30248729  0.63594776  0.17698525 15.21043755  0.02143605 

$convergence
[1] 0

$counts
function gradient 
    1276       NA 

$value
[1] 144.8785</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp1_data_agg</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">est</span>, <span class="va">exp1_data_agg</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exp1_data_agg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this case I didn’t have to use many starting values - the result is reached from almost everywhere:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 7
     prop prop_ltm   rate    tau  gain deviance convergence
    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
  1 0.303    0.636 0.0214 0.177  15.2      145.           0
  2 0.302    0.636 0.0214 0.177  15.2      145.           0
  3 0.302    0.636 0.0214 0.177  15.2      145.           0
  4 0.302    0.636 0.0214 0.177  15.2      145.           0
  5 0.302    0.636 0.0214 0.177  15.2      145.           0
  6 0.302    0.636 0.0214 0.177  15.2      145.           0
  7 0.302    0.636 0.0214 0.177  15.2      145.           0
  8 0.302    0.636 0.0214 0.177  15.2      145.           0
  9 0.302    0.636 0.0214 0.177  15.2      145.           0
 10 0.303    0.636 0.0214 0.177  15.2      145.           0
 11 0.302    0.636 0.0214 0.177  15.2      145.           0
 12 0.302    0.636 0.0214 0.177  15.2      145.           0
 13 0.303    0.636 0.0214 0.177  15.2      145.           0
 14 0.303    0.636 0.0214 0.177  15.2      145.           0
 15 0.302    0.636 0.0214 0.177  15.2      145.           0
 16 0.302    0.636 0.0214 0.177  15.2      145.           0
 17 0.302    0.636 0.0214 0.177  15.2      145.           0
 18 0.302    0.636 0.0214 0.177  15.2      145.           0
 19 0.302    0.636 0.0214 0.177  15.2      145.           0
 20 0.302    0.636 0.0214 0.177  15.2      145.           0
 21 0.302    0.636 0.0214 0.177  15.2      145.           0
 22 0.303    0.636 0.0215 0.177  15.2      145.           0
 23 0.302    0.636 0.0214 0.177  15.2      145.           0
 24 0.302    0.636 0.0214 0.177  15.2      145.           0
 25 0.302    0.636 0.0214 0.177  15.2      145.           0
 26 0.303    0.636 0.0214 0.177  15.2      145.           0
 27 0.303    0.636 0.0215 0.177  15.2      145.           0
 28 0.303    0.636 0.0214 0.177  15.2      145.           0
 29 0.303    0.636 0.0215 0.177  15.2      145.           0
 30 0.303    0.636 0.0215 0.177  15.2      145.           0
 31 0.303    0.636 0.0214 0.177  15.2      145.           0
 32 0.302    0.636 0.0214 0.177  15.2      145.           0
 33 0.302    0.636 0.0214 0.177  15.2      145.           0
 34 0.302    0.636 0.0214 0.177  15.2      145.           0
 35 0.302    0.636 0.0214 0.177  15.2      145.           0
 36 0.303    0.636 0.0214 0.177  15.2      145.           0
 37 0.303    0.636 0.0214 0.177  15.2      145.           0
 38 0.302    0.636 0.0214 0.177  15.2      145.           0
 39 0.302    0.636 0.0214 0.177  15.2      145.           0
 40 0.303    0.636 0.0214 0.177  15.2      145.           0
 41 0.303    0.636 0.0214 0.177  15.2      145.           0
 42 0.302    0.636 0.0214 0.177  15.2      145.           0
 43 0.302    0.636 0.0214 0.177  15.2      145.           0
 44 0.303    0.636 0.0215 0.177  15.2      145.           0
 45 0.303    0.636 0.0214 0.177  15.2      145.           0
 46 0.302    0.636 0.0214 0.177  15.2      145.           0
 47 0.302    0.636 0.0214 0.177  15.2      145.           0
 48 0.302    0.636 0.0214 0.177  15.2      145.           0
 49 0.303    0.636 0.0214 0.177  15.2      145.           0
 50 0.302    0.636 0.0214 0.177  15.2      145.           0
 51 0.302    0.636 0.0214 0.177  15.3      145.           0
 52 0.303    0.636 0.0215 0.177  15.2      145.           0
 53 0.303    0.636 0.0215 0.177  15.2      145.           0
 54 0.302    0.636 0.0214 0.177  15.2      145.           0
 55 0.302    0.636 0.0214 0.177  15.2      145.           0
 56 0.303    0.636 0.0214 0.177  15.2      145.           0
 57 0.303    0.636 0.0215 0.177  15.1      145.           0
 58 0.302    0.636 0.0214 0.177  15.2      145.           0
 59 0.302    0.636 0.0214 0.177  15.2      145.           0
 60 0.302    0.636 0.0214 0.177  15.2      145.           0
 61 0.303    0.636 0.0214 0.177  15.2      145.           0
 62 0.303    0.636 0.0215 0.177  15.2      145.           0
 63 0.302    0.636 0.0214 0.177  15.2      145.           0
 64 0.302    0.636 0.0214 0.177  15.2      145.           0
 65 0.302    0.636 0.0214 0.177  15.2      145.           0
 66 0.302    0.636 0.0214 0.177  15.2      145.           0
 67 0.302    0.636 0.0214 0.177  15.2      145.           0
 68 0.302    0.636 0.0214 0.177  15.2      145.           0
 69 0.303    0.636 0.0214 0.177  15.2      145.           0
 70 0.303    0.636 0.0214 0.177  15.2      145.           0
 71 0.303    0.636 0.0214 0.177  15.2      145.           0
 72 0.302    0.636 0.0214 0.177  15.2      145.           0
 73 0.302    0.636 0.0214 0.177  15.2      145.           0
 74 0.302    0.636 0.0214 0.177  15.2      145.           0
 75 0.302    0.636 0.0214 0.177  15.2      145.           0
 76 0.303    0.636 0.0214 0.177  15.2      145.           0
 77 0.302    0.636 0.0214 0.177  15.3      145.           0
 78 0.548    0.515 0.258  0.285   5.92     381.           0
 79 0.548    0.534 0.291  0.295   6.16     381.           0
 80 0.548    0.512 0.253  0.283   5.89     381.           0
 81 0.548    0.535 0.294  0.296   6.18     381.           0
 82 0.549    0.551 0.321  0.305   6.40     381.           0
 83 0.549    0.491 0.217  0.272   5.64     381.           0
 84 0.549    0.549 0.318  0.304   6.37     381.           0
 85 0.549    0.569 0.353  0.315   6.67     381.           0
 86 0.548    0.536 0.294  0.296   6.18     381.           0
 87 0.548    0.512 0.254  0.283   5.89     381.           0
 88 0.548    0.575 0.362  0.317   6.76     381.           0
 89 0.548    0.492 0.220  0.273   5.66     381.           0
 90 0.548    0.515 0.260  0.285   5.93     381.           0
 91 0.549    0.554 0.327  0.306   6.44     381.           0
 92 0.548    0.604 0.413  0.334   7.26     381.           0
 93 0.548    0.517 0.263  0.286   5.95     381.           0
 94 0.548    0.565 0.345  0.312   6.60     381.           0
 95 0.548    0.540 0.303  0.299   6.25     381.           0
 96 0.548    0.513 0.256  0.284   5.91     381.           0
 97 0.548    0.560 0.337  0.309   6.53     381.           0
 98 0.549    0.556 0.330  0.307   6.48     381.           0
 99 0.548    0.556 0.330  0.308   6.48     381.           0
100 0.106    0.473 0.275  0.0736 24.3     1663.           0</code></pre>
</div>
</div>
<section id="with-prior-on-rate" class="level3"><h3 class="anchored" data-anchor-id="with-prior-on-rate">With prior on rate</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"rate"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>deviance <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">exclude_sp1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">overall_deviance</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">par</span>, <span class="va">exp1_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 98 × 7
    prop prop_ltm  rate   tau  gain deviance convergence
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
 1 0.475    0.645 0.049 0.197  6.91     153.           0
 2 0.475    0.645 0.049 0.197  6.91     153.           0
 3 0.475    0.645 0.049 0.197  6.91     153.           0
 4 0.475    0.645 0.049 0.197  6.91     153.           0
 5 0.475    0.645 0.049 0.197  6.91     153.           0
 6 0.475    0.645 0.049 0.197  6.91     153.           0
 7 0.475    0.644 0.049 0.197  6.90     153.           0
 8 0.475    0.644 0.049 0.197  6.91     153.           0
 9 0.475    0.644 0.049 0.197  6.91     153.           0
10 0.475    0.645 0.049 0.197  6.90     153.           0
11 0.475    0.644 0.049 0.197  6.91     153.           0
12 0.475    0.645 0.049 0.197  6.91     153.           0
13 0.475    0.645 0.049 0.197  6.91     153.           0
14 0.475    0.644 0.049 0.197  6.91     153.           0
15 0.475    0.645 0.049 0.197  6.91     153.           0
16 0.475    0.645 0.049 0.197  6.91     153.           0
17 0.475    0.644 0.049 0.197  6.91     153.           0
18 0.475    0.645 0.049 0.197  6.91     153.           0
19 0.475    0.645 0.049 0.197  6.91     153.           0
20 0.475    0.645 0.049 0.197  6.91     153.           0
21 0.475    0.645 0.049 0.197  6.90     153.           0
22 0.475    0.644 0.049 0.197  6.91     153.           0
23 0.475    0.645 0.049 0.197  6.91     153.           0
24 0.475    0.645 0.049 0.197  6.90     153.           0
25 0.475    0.645 0.049 0.197  6.90     153.           0
26 0.475    0.645 0.049 0.197  6.90     153.           0
27 0.475    0.645 0.049 0.197  6.91     153.           0
28 0.475    0.645 0.049 0.197  6.90     153.           0
29 0.475    0.645 0.049 0.197  6.91     153.           0
30 0.475    0.645 0.049 0.197  6.91     153.           0
31 0.475    0.644 0.049 0.197  6.91     153.           0
32 0.475    0.645 0.049 0.197  6.91     153.           0
33 0.475    0.645 0.049 0.197  6.91     153.           0
34 0.475    0.645 0.049 0.197  6.91     153.           0
35 0.475    0.645 0.049 0.197  6.90     153.           0
36 0.475    0.644 0.049 0.197  6.91     153.           0
37 0.475    0.645 0.049 0.197  6.91     153.           0
38 0.475    0.645 0.049 0.197  6.90     153.           0
39 0.475    0.645 0.049 0.197  6.91     153.           0
40 0.475    0.644 0.049 0.197  6.90     153.           0
41 0.475    0.645 0.049 0.197  6.91     153.           0
42 0.475    0.645 0.049 0.197  6.90     153.           0
43 0.475    0.644 0.049 0.197  6.91     153.           0
44 0.475    0.645 0.049 0.197  6.90     153.           0
45 0.475    0.645 0.049 0.197  6.90     153.           0
46 0.475    0.645 0.049 0.197  6.90     153.           0
47 0.475    0.644 0.049 0.197  6.91     153.           0
48 0.475    0.645 0.049 0.197  6.91     153.           0
49 0.475    0.645 0.049 0.197  6.90     153.           0
50 0.475    0.645 0.049 0.197  6.90     153.           0
51 0.475    0.645 0.049 0.197  6.91     153.           0
52 0.475    0.645 0.049 0.197  6.91     153.           0
53 0.475    0.644 0.049 0.197  6.91     153.           0
54 0.475    0.645 0.049 0.197  6.90     153.           0
55 0.475    0.645 0.049 0.197  6.91     153.           0
56 0.475    0.644 0.049 0.197  6.91     153.           0
57 0.475    0.645 0.049 0.197  6.90     153.           0
58 0.475    0.644 0.049 0.197  6.91     153.           0
59 0.475    0.644 0.049 0.197  6.90     153.           0
60 0.475    0.645 0.049 0.197  6.91     153.           0
61 0.475    0.645 0.049 0.197  6.90     153.           0
62 0.475    0.645 0.049 0.197  6.90     153.           0
63 0.475    0.645 0.049 0.197  6.90     153.           0
64 0.475    0.645 0.049 0.197  6.90     153.           0
65 0.475    0.645 0.049 0.197  6.90     153.           0
66 0.475    0.645 0.049 0.197  6.91     153.           0
67 0.475    0.645 0.049 0.197  6.90     153.           0
68 0.475    0.645 0.049 0.197  6.91     153.           0
69 0.475    0.644 0.049 0.197  6.90     153.           0
70 0.475    0.645 0.049 0.197  6.90     153.           0
71 0.475    0.645 0.049 0.197  6.90     153.           0
72 0.476    0.644 0.049 0.197  6.89     153.           0
73 0.475    0.645 0.049 0.197  6.91     153.           0
74 0.475    0.645 0.049 0.197  6.90     153.           0
75 0.475    0.645 0.049 0.197  6.90     153.           0
76 0.475    0.645 0.049 0.197  6.90     153.           0
77 0.475    0.644 0.049 0.197  6.90     153.           0
78 0.475    0.644 0.049 0.197  6.90     153.           0
79 0.475    0.644 0.049 0.197  6.91     153.           0
80 0.475    0.645 0.049 0.197  6.90     153.           0
81 0.475    0.645 0.049 0.197  6.90     153.           0
82 0.475    0.644 0.049 0.197  6.90     153.           0
83 0.475    0.645 0.049 0.197  6.91     153.           0
84 0.475    0.645 0.049 0.197  6.90     153.           0
85 0.475    0.645 0.049 0.197  6.91     153.           0
86 0.475    0.645 0.049 0.197  6.90     153.           0
87 0.475    0.645 0.049 0.197  6.90     153.           0
88 0.476    0.644 0.049 0.197  6.90     153.           0
89 0.475    0.645 0.049 0.197  6.90     153.           0
90 0.475    0.644 0.049 0.197  6.90     153.           0
91 0.475    0.645 0.049 0.197  6.90     153.           0
92 0.476    0.644 0.049 0.197  6.9      153.           0
93 0.475    0.645 0.049 0.197  6.91     153.           0
94 0.476    0.645 0.049 0.197  6.90     153.           0
95 0.475    0.645 0.049 0.197  6.90     153.           0
96 0.476    0.644 0.049 0.197  6.90     153.           0
97 0.476    0.645 0.049 0.197  6.89     153.           0
98 0.476    0.645 0.049 0.197  6.90     153.           0</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"rate"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">"fit"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exp1_data_agg</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">exp1_data_agg</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exp1_data_agg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="repeat-for-expereiment-2" class="level2"><h2 class="anchored" data-anchor-id="repeat-for-expereiment-2">Repeat for expereiment 2</h2>
<p>Basic estimation (ignoring first chunk):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_load.html">tar_load</a></span><span class="op">(</span><span class="va">exp2_data_agg</span><span class="op">)</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu">paper_params</span><span class="op">(</span>exp <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">estimate_model</span><span class="op">(</span><span class="va">start</span>, data <span class="op">=</span> <span class="va">exp2_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$start
    prop prop_ltm      tau     gain     rate 
   0.170    0.400    0.135   25.000    0.025 

$par
       prop    prop_ltm         tau        gain        rate 
 0.16975119  0.48023531  0.13651974 29.75877754  0.02233212 

$convergence
[1] 0

$counts
function gradient 
     246       NA 

$value
[1] 56.36045</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp2_data_agg</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">est</span>, <span class="va">exp2_data_agg</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exp2_data_agg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>again parameter estimates are different from the paper.</p>
<p>Here are from multiple starting values:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span>, <span class="va">fit</span>, <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 98 × 9
    prop prop_ltm  rate   tau  gain deviance convergence fit        data             
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
 1 0.105    0.815 0.007 0.089  87.8     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 2 0.105    0.816 0.007 0.089  86.9     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 3 0.105    0.815 0.007 0.089  87.7     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 4 0.105    0.816 0.007 0.089  87.2     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 5 0.105    0.815 0.007 0.089  88.1     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 6 0.106    0.816 0.007 0.09   85.3     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 7 0.109    0.816 0.007 0.092  81.6     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 8 0.128    0.818 0.008 0.105  59.5     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 9 0.135    0.818 0.009 0.109  54.5     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
10 0.152    0.819 0.01  0.119  43.3     40.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
11 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
12 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
13 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
14 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
15 0.162    0.481 0.021 0.132  32.5     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
16 0.162    0.481 0.021 0.132  32.6     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
17 0.163    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
18 0.163    0.48  0.021 0.132  32.1     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
19 0.163    0.48  0.021 0.132  32.3     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
20 0.163    0.48  0.021 0.132  32.3     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
21 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
22 0.271    0.505 0.12  0.205  13.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
23 0.271    0.526 0.138 0.208  14.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
24 0.271    0.656 0.249 0.225  20.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
25 0.271    0.564 0.171 0.213  15.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
26 0.271    0.487 0.105 0.203  13.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
27 0.271    0.521 0.134 0.207  14.3     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
28 0.271    0.795 0.367 0.244  33.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
29 0.271    0.628 0.225 0.222  18.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
30 0.271    0.721 0.304 0.234  24.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
31 0.271    0.787 0.361 0.243  32.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
32 0.271    0.755 0.333 0.238  28.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
33 0.271    0.544 0.154 0.21   15.1     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
34 0.271    0.531 0.143 0.209  14.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
35 0.271    0.723 0.306 0.234  24.7     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
36 0.271    0.645 0.239 0.224  19.3     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
37 0.271    0.591 0.193 0.217  16.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
38 0.271    0.591 0.194 0.217  16.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
39 0.271    0.654 0.247 0.225  19.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
40 0.271    0.645 0.24  0.224  19.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
41 0.271    0.571 0.176 0.214  16.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
42 0.271    0.759 0.336 0.239  28.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
43 0.271    0.635 0.231 0.223  18.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
44 0.271    0.73  0.312 0.235  25.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
45 0.271    0.718 0.302 0.234  24.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
46 0.271    0.593 0.195 0.217  16.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
47 0.271    0.622 0.219 0.221  18.1     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
48 0.271    0.707 0.293 0.232  23.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
49 0.271    0.495 0.111 0.204  13.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
50 0.271    0.643 0.238 0.224  19.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
51 0.271    0.718 0.302 0.234  24.3     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
52 0.271    0.648 0.242 0.224  19.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
53 0.271    0.72  0.304 0.234  24.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
54 0.271    0.666 0.257 0.227  20.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
55 0.271    0.601 0.202 0.218  17.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
56 0.271    0.45  0.073 0.198  12.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
57 0.271    0.561 0.168 0.213  15.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
58 0.271    0.527 0.139 0.208  14.5     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
59 0.271    0.532 0.143 0.209  14.7     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
60 0.271    0.802 0.373 0.245  34.7     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
61 0.271    0.627 0.224 0.221  18.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
62 0.271    0.619 0.218 0.22   18.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
63 0.271    0.62  0.218 0.221  18.1     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
64 0.271    0.575 0.18  0.215  16.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
65 0.271    0.645 0.24  0.224  19.3     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
66 0.271    0.507 0.121 0.205  13.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
67 0.271    0.635 0.23  0.222  18.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
68 0.271    0.724 0.307 0.235  24.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
69 0.271    0.711 0.296 0.233  23.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
70 0.271    0.485 0.104 0.203  13.4     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
71 0.271    0.64  0.236 0.223  19.1     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
72 0.271    0.841 0.406 0.25   43.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
73 0.271    0.684 0.273 0.229  21.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
74 0.271    0.539 0.149 0.21   14.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
75 0.27     0.812 0.381 0.246  36.7     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
76 0.271    0.57  0.175 0.214  16.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
77 0.271    0.852 0.416 0.251  46.3     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
78 0.271    0.425 0.052 0.195  11.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
79 0.271    0.561 0.168 0.213  15.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
80 0.271    0.48  0.099 0.202  13.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
81 0.271    0.656 0.249 0.225  20.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
82 0.271    0.743 0.323 0.237  26.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
83 0.271    0.678 0.268 0.228  21.3     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
84 0.271    0.592 0.194 0.217  16.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
85 0.271    0.624 0.222 0.221  18.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
86 0.271    0.742 0.322 0.237  26.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
87 0.271    0.671 0.262 0.227  20.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
88 0.271    0.508 0.122 0.206  13.9     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
89 0.271    0.537 0.147 0.21   14.8     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
90 0.271    0.572 0.177 0.214  16.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
91 0.271    0.541 0.151 0.21   15.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
92 0.271    0.667 0.258 0.227  20.6     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
93 0.271    0.833 0.4   0.249  41.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
94 0.348    0.266 0.289 0.272  10.7     84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
95 0.348    0.279 0.291 0.272  10.8     84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
96 0.584    0.725 0.218 1       0      623.            0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
97 0.616    0.715 0.273 1       0      623.            0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
98 0.612    0.541 0.248 1       0      623.            0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
</div>
<section id="problem-with-parameter-identifiability" class="level3"><h3 class="anchored" data-anchor-id="problem-with-parameter-identifiability">Problem with parameter identifiability</h3>
<p>rows 12-16 illustrate the problem with parameter identifiability quite well. They have nearly identical deviance, but very different parameters.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="va">fits</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 9
   prop prop_ltm  rate   tau  gain deviance convergence fit        data             
  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
1 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
2 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
3 0.162    0.481 0.021 0.132  32.4     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
4 0.162    0.481 0.021 0.132  32.5     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
5 0.162    0.481 0.021 0.132  32.6     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># saveRDS(fits, "output/five_parsets_exp2.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plot the predictions all 5 sets of parameters:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prop</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The way parameters change suggest that increasing prop can be compensated by increasing rate, taun and decreasing gain. Here’s a pair plot of these parameters</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span>, <span class="va">rate</span>, <span class="va">tau</span>, <span class="va">gain</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span>diag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="st">"blankDiag"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(x, y): the standard deviation is zero
Warning in cor(x, y): the standard deviation is zero
Warning in cor(x, y): the standard deviation is zero
Warning in cor(x, y): the standard deviation is zero
Warning in cor(x, y): the standard deviation is zero
Warning in cor(x, y): the standard deviation is zero</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I’ll investigate this in a separate notebook.</p>
</section><section id="with-prior-on-gain" class="level3"><h3 class="anchored" data-anchor-id="with-prior-on-gain">With prior on gain</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"gain"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>deviance <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">exclude_sp1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">overall_deviance</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">par</span>, <span class="va">exp2_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span>, <span class="va">fit</span>, <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 98 × 9
    prop prop_ltm  rate   tau  gain deviance convergence fit        data             
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
 1 0.205    0.824 0.013 0.146  25.0     40.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 2 0.205    0.824 0.013 0.146  25.0     40.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 3 0.205    0.824 0.013 0.146  25.0     40.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 4 0.205    0.824 0.013 0.146  25.0     40.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 5 0.204    0.824 0.013 0.146  25.0     40.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 6 0.205    0.824 0.013 0.146  25.0     40.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 7 0.186    0.479 0.025 0.146  25       56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 8 0.186    0.479 0.025 0.146  25       56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 9 0.186    0.479 0.025 0.146  25.0     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
10 0.186    0.479 0.025 0.146  25.0     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
11 0.186    0.479 0.025 0.146  25       56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
12 0.186    0.48  0.025 0.146  25.0     56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
13 0.271    0.726 0.309 0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
14 0.271    0.726 0.308 0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
15 0.271    0.725 0.308 0.234  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
16 0.271    0.726 0.308 0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
17 0.272    0.727 0.31  0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
18 0.272    0.727 0.31  0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
19 0.272    0.726 0.31  0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
20 0.271    0.725 0.307 0.234  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
21 0.271    0.725 0.308 0.234  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
22 0.271    0.726 0.309 0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
23 0.27     0.724 0.306 0.234  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
24 0.271    0.725 0.307 0.234  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
25 0.27     0.724 0.305 0.233  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
26 0.27     0.724 0.305 0.233  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
27 0.269    0.722 0.303 0.233  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
28 0.27     0.723 0.304 0.233  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
29 0.272    0.727 0.309 0.235  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
30 0.269    0.721 0.302 0.232  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
31 0.272    0.727 0.31  0.235  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
32 0.269    0.72  0.302 0.232  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
33 0.276    0.735 0.323 0.24   25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
34 0.264    0.712 0.289 0.228  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
35 0.263    0.709 0.286 0.227  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
36 0.271    0.726 0.308 0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
37 0.27     0.724 0.306 0.234  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
38 0.281    0.744 0.337 0.245  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
39 0.271    0.725 0.308 0.234  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
40 0.284    0.749 0.343 0.247  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
41 0.286    0.751 0.348 0.249  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
42 0.255    0.693 0.264 0.219  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
43 0.268    0.719 0.299 0.231  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
44 0.271    0.726 0.309 0.235  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
45 0.253    0.688 0.259 0.217  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
46 0.272    0.728 0.311 0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
47 0.289    0.756 0.356 0.252  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
48 0.25     0.681 0.25  0.214  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
49 0.279    0.741 0.331 0.243  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
50 0.292    0.762 0.365 0.255  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
51 0.249    0.678 0.246 0.213  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
52 0.249    0.679 0.247 0.213  25.0     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
53 0.271    0.725 0.307 0.234  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
54 0.246    0.669 0.236 0.209  25.0     63.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
55 0.272    0.727 0.31  0.235  25.0     63.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
56 0.271    0.725 0.308 0.234  25.0     63.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
57 0.271    0.726 0.308 0.234  25       63.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
58 0.231    0.628 0.192 0.195  25.0     63.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
59 0.271    0.725 0.308 0.234  25       63.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
60 0.271    0.725 0.308 0.234  25       63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
61 0.224    0.606 0.17  0.188  25       63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
62 0.222    0.6   0.165 0.186  25       63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
63 0.221    0.596 0.161 0.185  25       63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
64 0.271    0.726 0.308 0.235  25       63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
65 0.204    0.529 0.105 0.167  25.0     63.6           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
66 0.271    0.725 0.308 0.234  25.0     63.6           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
67 0.203    0.526 0.102 0.167  25       63.6           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
68 0.271    0.725 0.308 0.234  25       63.6           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
69 0.2      0.514 0.094 0.164  25       63.6           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
70 0.2      0.513 0.093 0.164  25.0     63.6           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
71 0.195    0.487 0.074 0.159  25.0     63.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
72 0.271    0.725 0.307 0.234  25       63.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
73 0.191    0.468 0.061 0.155  25       63.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
74 0.188    0.451 0.05  0.152  25.0     63.8           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
75 0.271    0.726 0.309 0.236  25.0     63.8           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
76 0.271    0.725 0.307 0.235  25.0     64.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
77 0.271    0.726 0.309 0.234  25       64.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
78 0.271    0.725 0.308 0.236  25.0     66.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
79 0.974    0.994 0.003 0.008  25.0     69.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
80 0.974    0.994 0.003 0.008  25.0     69.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
81 0.348    0.221 0.522 0.315  25       84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
82 0.348    0.721 0.521 0.315  25       84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
83 0.348    0.195 0.521 0.315  25       84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
84 0.348    0.418 0.521 0.315  25.0     84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
85 0.348    0.204 0.522 0.315  25       84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
86 0.348    0.315 0.522 0.315  25.0     84.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
87 0.348    0.237 0.521 0.315  25       84.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
88 0.327    0.704 0.468 0.294  25       84.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
89 0.348    0.112 0.522 0.316  25       84.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
90 0.317    0.637 0.444 0.284  25       84.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
91 0.348    0.303 0.521 0.315  25.0     84.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
92 0.31     0.485 0.426 0.277  25       84.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
93 0.303    0.612 0.409 0.271  25.0     84.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
94 0.347    0.158 0.52  0.315  25.0     84.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
95 0.348    0.58  0.52  0.314  25.0     84.6           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
96 0.347    0.586 0.52  0.316  25.0     86.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
97 0.346    0.505 0.517 0.315  25       88.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
98 0.11     0.733 0.277 0.1    25      473.            0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
</div>
<p>I see three sets of parameters that are close in deviance (relatively):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">13</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">fits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 9
   prop prop_ltm  rate   tau  gain deviance convergence fit        data             
  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
1 0.205    0.824 0.013 0.146  25.0     40.7           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
2 0.186    0.479 0.025 0.146  25       56.4           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
3 0.271    0.726 0.309 0.235  25       63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
</div>
<p>plots</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prop</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>this case is particularly interesting. The bestfitting parameters produce almost no interaction. The other two sets of parameters produce a strong interaction, but misfit the overall data.</p>
<p>Further, the parameter set with rate 0.024 and 0.271 have quite similar fits despite very different parameter sets!</p>
</section><section id="with-prior-on-rate-1" class="level3"><h3 class="anchored" data-anchor-id="with-prior-on-rate-1">with prior on rate</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"rate"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>deviance <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">exclude_sp1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">overall_deviance</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">par</span>, <span class="va">exp2_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span>, <span class="va">fit</span>, <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 99 × 9
    prop prop_ltm  rate   tau  gain deviance convergence fit        data             
   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
 1 0.474    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 2 0.474    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 3 0.474    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 4 0.475    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 5 0.474    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 6 0.475    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 7 0.475    0.845 0.032 0.196  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 8 0.475    0.844 0.032 0.196  5.85     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
 9 0.474    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
10 0.475    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
11 0.475    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
12 0.475    0.844 0.032 0.196  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
13 0.475    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
14 0.475    0.844 0.032 0.197  5.86     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
15 0.475    0.845 0.032 0.196  5.85     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
16 0.475    0.844 0.032 0.196  5.85     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
17 0.475    0.844 0.032 0.197  5.85     47.0           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
18 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
19 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
20 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
21 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
22 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
23 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
24 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
25 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
26 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
27 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
28 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
29 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
30 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
31 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
32 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
33 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
34 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
35 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
36 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
37 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
38 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
39 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
40 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
41 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
42 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
43 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
44 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
45 0.271    0.482 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
46 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
47 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
48 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
49 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
50 0.271    0.481 0.1   0.202 13.3      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
51 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
52 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
53 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
54 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
55 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
56 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
57 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
58 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
59 0.271    0.482 0.1   0.202 13.3      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
60 0.272    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
61 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
62 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
63 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
64 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
65 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
66 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
67 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
68 0.27     0.481 0.1   0.202 13.3      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
69 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
70 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
71 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
72 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
73 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
74 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
75 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
76 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
77 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
78 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
79 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
80 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
81 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
82 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
83 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
84 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
85 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
86 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
87 0.271    0.481 0.1   0.202 13.2      63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
88 0.474    0.435 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
89 0.474    0.435 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
90 0.474    0.434 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
91 0.474    0.434 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
92 0.474    0.435 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
93 0.474    0.435 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
94 0.474    0.434 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
95 0.474    0.435 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
96 0.474    0.434 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
97 0.474    0.435 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
98 0.474    0.434 0.072 0.245  4.28     63.5           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
99 0.509    0.398 0.102 0.258  3.72     68.2           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
</div>
<p>plots</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">28</span>, <span class="fl">43</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># previous 83</span></span>
<span><span class="va">fits</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 9
   prop prop_ltm  rate   tau  gain deviance convergence fit        data             
  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
1 0.271    0.481   0.1 0.202  13.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
2 0.271    0.481   0.1 0.202  13.2     63.3           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prop</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="including-the-first-chunk-in-the-optimization-1" class="level3"><h3 class="anchored" data-anchor-id="including-the-first-chunk-in-the-optimization-1">Including the first chunk in the optimization</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu">paper_params</span><span class="op">(</span>exp <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">estimate_model</span><span class="op">(</span><span class="va">start</span>, data <span class="op">=</span> <span class="va">exp2_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$start
    prop prop_ltm      tau     gain     rate 
   0.170    0.400    0.135   25.000    0.025 

$par
      prop   prop_ltm        tau       gain       rate 
 0.1618193  0.8723027  0.1235086 43.4849440  0.0080991 

$convergence
[1] 0

$counts
function gradient 
     412       NA 

$value
[1] 116.1887</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exp2_data_agg</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">est</span>, <span class="va">exp2_data_agg</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">exp2_data_agg</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>from multiple starting values:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span>, <span class="va">fit</span>, <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
   prop prop_ltm  rate   tau  gain deviance convergence fit        data             
  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
1 0.38     0.862  0.02 0.189  8.98     110.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
2 0.38     0.862  0.02 0.189  8.98     110.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
3 0.38     0.862  0.02 0.189  8.98     110.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
4 0.379    0.862  0.02 0.189  8.98     110.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
5 0.38     0.862  0.02 0.189  8.98     110.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
6 0.38     0.862  0.02 0.189  8.98     110.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
</div>
</section><section id="with-prior-on-rate-2" class="level3"><h3 class="anchored" data-anchor-id="with-prior-on-rate-2">With prior on rate</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"rate"</span>, <span class="va">exclude_sp1</span> <span class="op">==</span> <span class="cn">FALSE</span>, <span class="va">exp</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>deviance <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">exclude_sp1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">overall_deviance</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">par</span>, <span class="va">exp2_data_agg</span>, exclude_sp1 <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">prop</span><span class="op">:</span><span class="va">convergence</span>, <span class="va">fit</span>, <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
   prop prop_ltm  rate   tau  gain deviance convergence fit        data             
  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;list&gt;     &lt;list&gt;           
1 0.501    0.857 0.032 0.192  5.56     114.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
2 0.501    0.857 0.032 0.192  5.55     114.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
3 0.502    0.857 0.032 0.192  5.55     114.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
4 0.501    0.858 0.032 0.192  5.56     114.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
5 0.501    0.857 0.032 0.192  5.55     114.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;
6 0.501    0.858 0.032 0.192  5.55     114.           0 &lt;srl_rcl_&gt; &lt;tibble [12 × 8]&gt;</code></pre>
</div>
</div>
<p>plot predictions</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span>, \<span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chunk"</span>, <span class="st">"gap"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prop</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"First chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">itemtype</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="summary" class="level2"><h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>The parameters reported in the paper are not the best fitting</li>
<li>When I start from 100 different starting values, I get better fitting parameters, but with an even lower <code>rate</code>
</li>
<li>I can reproduce the parameters from the paper if I fix the gain parameter to 25</li>
</ul>
<section id="best-fitting-parameters" class="level3"><h3 class="anchored" data-anchor-id="best-fitting-parameters">Best fitting parameters</h3>
<p>Given the different modeling choices (ignoring the first chunk or not, priors on the parameters)</p>
<p>TODO: make this into a function for getting the final parameters</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final</span> <span class="op">&lt;-</span> <span class="va">fits1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">priors_scenario</span>, <span class="va">exclude_sp1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">exclude_sp1</span><span class="op">)</span>, <span class="va">exp</span>, <span class="va">priors_scenario</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    deviance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">deviance</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    priors_scenario <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"none"</span> <span class="op">~</span> <span class="st">"None"</span>,</span>
<span>      <span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"gain"</span> <span class="op">~</span> <span class="st">"Gain ~ N(25, 0.1)"</span>,</span>
<span>      <span class="va">priors_scenario</span> <span class="op">==</span> <span class="st">"rate"</span> <span class="op">~</span> <span class="st">"Rate ~ N(0.1, 0.01)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">final</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">priors_scenario</span>, <span class="va">exclude_sp1</span>, <span class="va">prop</span><span class="op">:</span><span class="va">gain</span>, <span class="va">deviance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">exp</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">priors_scenario</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">exclude_sp1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">prop</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">prop_ltm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tau</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">gain</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">deviance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Gain ~ N(25, 0.1)</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">0.154</td>
<td style="text-align: right;">25.002</td>
<td style="text-align: right;">33.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0.106</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.090</td>
<td style="text-align: right;">100.000</td>
<td style="text-align: right;">31.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Rate ~ N(0.1, 0.01)</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0.435</td>
<td style="text-align: right;">0.608</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.202</td>
<td style="text-align: right;">7.590</td>
<td style="text-align: right;">43.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Gain ~ N(25, 0.1)</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">25.001</td>
<td style="text-align: right;">40.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.815</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">87.787</td>
<td style="text-align: right;">40.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Rate ~ N(0.1, 0.01)</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">0.197</td>
<td style="text-align: right;">5.865</td>
<td style="text-align: right;">47.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Gain ~ N(25, 0.1)</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">24.999</td>
<td style="text-align: right;">145.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.303</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.177</td>
<td style="text-align: right;">15.206</td>
<td style="text-align: right;">144.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Rate ~ N(0.1, 0.01)</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.475</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">0.197</td>
<td style="text-align: right;">6.907</td>
<td style="text-align: right;">152.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Gain ~ N(25, 0.1)</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.217</td>
<td style="text-align: right;">0.874</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">24.997</td>
<td style="text-align: right;">113.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.380</td>
<td style="text-align: right;">0.862</td>
<td style="text-align: right;">0.020</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">8.983</td>
<td style="text-align: right;">109.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Rate ~ N(0.1, 0.01)</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.032</td>
<td style="text-align: right;">0.192</td>
<td style="text-align: right;">5.557</td>
<td style="text-align: right;">113.8</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>prop_ltm very different between the two experiments (overfitting…)</li>
</ul></section><section id="predictions" class="level3"><h3 class="anchored" data-anchor-id="predictions">Predictions</h3>
<p>(the two experiments are modeled separately)</p>
</section><section id="all-predictions" class="level3"><h3 class="anchored" data-anchor-id="all-predictions">All predictions</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">exp</span>, <span class="va">rate</span>, <span class="va">data</span>, <span class="va">pred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Exp "</span>, <span class="va">exp</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">rate</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"1st chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_linetype.html">scale_linetype_discrete</a></span><span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">exp</span> <span class="op">~</span> <span class="va">itemtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_pub</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="816"></p>
</figure>
</div>
</div>
</div>
</section><section id="experiment-1" class="level3"><h3 class="anchored" data-anchor-id="experiment-1">Experiment 1</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">exp</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">rate</span>, <span class="va">data</span>, <span class="va">pred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">rate</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span>, linetype <span class="op">=</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"1st chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_linetype.html">scale_linetype_discrete</a></span><span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">rate</span> <span class="op">~</span> <span class="va">itemtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_pub</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="816"></p>
</figure>
</div>
</div>
</div>
</section><section id="experiment-2" class="level3"><h3 class="anchored" data-anchor-id="experiment-2">Experiment 2</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">exp</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">rate</span>, <span class="va">data</span>, <span class="va">pred</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">rate</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gap</span>, y <span class="op">=</span> <span class="va">p_correct</span>, color <span class="op">=</span> <span class="va">chunk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">pred</span>, linetype <span class="op">=</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">"1st chunk LTM?"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_linetype.html">scale_linetype_discrete</a></span><span class="op">(</span><span class="st">"Rate"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">rate</span> <span class="op">~</span> <span class="va">itemtype</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_pub</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="modelling_edas_approach_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="816"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/venpopov\.github\.io\/ltmTimeBenefit\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../../quarto/notebooks/subject_data.html" class="pagination-link" aria-label="Subject-level data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Subject-level data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../quarto/notebooks/par_identifiability.html" class="pagination-link" aria-label="Parameter identifiability">
        <span class="nav-page-text">Parameter identifiability</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb59" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Main results"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: init</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co"># load "R/*" scripts and saved R objects from the targets pi</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_source</span>()</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(<span class="fu">c</span>(exp1_data, exp2_data, exp1_data_agg, exp2_data_agg, fits1))</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>Here I apply the model described in the May 13th draft of the paper to the data. I will first ignore the first chunk in the optimization, then include it. I will also try different priors on the parameters to understand the paramater space. Final results from different choices summarized at the end.</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ignoring first chunk in the optimiziation</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic estimation of Exp1</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>Let's apply the modeling approach reported in the paper. We ignore the first chunk (SP1-3) while evaluating the likelihood. Eda did this because the model as implemented predicts the same performance for known and random chunks.</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model 1</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(exp1_data_agg)</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">paper_params</span>()</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>(est <span class="ot">&lt;-</span> <span class="fu">estimate_model</span>(start, <span class="at">data =</span> exp1_data_agg, <span class="at">exclude_sp1 =</span> <span class="cn">TRUE</span>))</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>exp1_data_agg<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(est, exp1_data_agg, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>))</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>exp1_data_agg <span class="sc">|&gt;</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>I get startlingly different paramemter estimates. Much lower <span class="in">`prop`</span> and <span class="in">`rate`</span> and <span class="in">`tau`</span>, higher <span class="in">`gain`</span>.</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trying different starting values</span></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a><span class="co"># load the fits of the first simulation, calculate the deviance(s) and predictions</span></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(fits1)</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>fits1 <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">deviance =</span> <span class="fu">pmap_dbl</span>(</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(fit, data, exclude_sp1),</span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">overall_deviance</span>(<span class="at">params =</span> <span class="st">`</span><span class="at">..1</span><span class="st">`</span><span class="sc">$</span>par, <span class="at">data =</span> <span class="st">`</span><span class="at">..2</span><span class="st">`</span>, <span class="at">exclude_sp1 =</span> <span class="st">`</span><span class="at">..3</span><span class="st">`</span>)</span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred =</span> <span class="fu">map2</span>(fit, data, <span class="sc">~</span> <span class="fu">predict</span>(.x, .y, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>)))</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>I've run this with many different starting values. We tend to end up in different regions of the parameter space (the top result close to the paper's estimates):</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"none"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, deviance <span class="sc">&lt;=</span> <span class="dv">50</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence) <span class="sc">|&gt;</span></span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(gain) <span class="sc">|&gt;</span></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trying priors of the gain parameter</span></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>One way to deal with that is to put a prior on the gain parameter to keep it near 25. I know priors are usually a bayesian thing, but they work with ML optimization just as well. On the next set of simulations, I used a Normal(25, 0.1) prior on the gain parameter (could have also fixed it to this value, but this gives me mroe control).</span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"gain"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, deviance <span class="sc">&lt;=</span> <span class="dv">50</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence) <span class="sc">|&gt;</span></span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(gain) <span class="sc">|&gt;</span></span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a>So we do get at least some parameters that are close to that reported in the paper. The predictions with those parameters:</span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a>exp1_data_agg<span class="sc">$</span>pred <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"gain"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"pred"</span>, <span class="dv">1</span>)</span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a>exp1_data_agg <span class="sc">|&gt;</span></span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trying priors on the rate parameter</span></span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a>Maybe there is a region with a higher rate that we have not explored? Let's try a prior on the rate parameter, ~ Normal(0.1, 0.01).</span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a>fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"rate"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence) <span class="sc">|&gt;</span></span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true" tabindex="-1"></a>Deviance is quite much higher. Predictions?</span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"rate"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"fit"</span>, <span class="dv">1</span>)</span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>par</span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a>exp1_data_agg<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, exp1_data_agg, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>))</span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true" tabindex="-1"></a>exp1_data_agg <span class="sc">|&gt;</span></span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-151"><a href="#cb59-151" aria-hidden="true" tabindex="-1"></a>Geater mismatch. Let's include error bars of the data:</span>
<span id="cb59-152"><a href="#cb59-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true" tabindex="-1"></a>exp1_data <span class="sc">|&gt;</span></span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id, chunk, gap, itemtype) <span class="sc">|&gt;</span></span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_total =</span> dplyr<span class="sc">::</span><span class="fu">n</span>(),</span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_correct =</span> <span class="fu">sum</span>(cor),</span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_correct =</span> <span class="fu">mean</span>(cor)</span>
<span id="cb59-162"><a href="#cb59-162" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb59-163"><a href="#cb59-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(exp1_data_agg, chunk, gap, itemtype, pred),</span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>, <span class="st">"itemtype"</span>)</span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>() <span class="sc">+</span></span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-174"><a href="#cb59-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-175"><a href="#cb59-175" aria-hidden="true" tabindex="-1"></a>Paraneters seem consistent with the data (see <span class="co">[</span><span class="ot">my notes</span><span class="co">](../notes.qmd)</span>).</span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true" tabindex="-1"></a><span class="fu">## Including the first chunk in the optimization</span></span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true" tabindex="-1"></a>The reports above followed the approach in the current draft and excluded the first chunk from the calculation of the likelihood when optimizing the parameters. Let's include it:</span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-184"><a href="#cb59-184" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">paper_params</span>()</span>
<span id="cb59-185"><a href="#cb59-185" aria-hidden="true" tabindex="-1"></a>(est <span class="ot">&lt;-</span> <span class="fu">estimate_model</span>(start, <span class="at">data =</span> exp1_data_agg, <span class="at">exclude_sp1 =</span> <span class="cn">FALSE</span>))</span>
<span id="cb59-186"><a href="#cb59-186" aria-hidden="true" tabindex="-1"></a>exp1_data_agg<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(est, exp1_data_agg, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>))</span>
<span id="cb59-187"><a href="#cb59-187" aria-hidden="true" tabindex="-1"></a>exp1_data_agg <span class="sc">|&gt;</span></span>
<span id="cb59-188"><a href="#cb59-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-189"><a href="#cb59-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-190"><a href="#cb59-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-191"><a href="#cb59-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb59-192"><a href="#cb59-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-193"><a href="#cb59-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-194"><a href="#cb59-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-195"><a href="#cb59-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-196"><a href="#cb59-196" aria-hidden="true" tabindex="-1"></a>In this case I didn't have to use many starting values - the result is reached from almost everywhere:</span>
<span id="cb59-197"><a href="#cb59-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-200"><a href="#cb59-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-201"><a href="#cb59-201" aria-hidden="true" tabindex="-1"></a>fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-202"><a href="#cb59-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"none"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">FALSE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-203"><a href="#cb59-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-204"><a href="#cb59-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence) <span class="sc">|&gt;</span></span>
<span id="cb59-205"><a href="#cb59-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-206"><a href="#cb59-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-207"><a href="#cb59-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-208"><a href="#cb59-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-209"><a href="#cb59-209" aria-hidden="true" tabindex="-1"></a><span class="fu">### With prior on rate</span></span>
<span id="cb59-210"><a href="#cb59-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-213"><a href="#cb59-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-214"><a href="#cb59-214" aria-hidden="true" tabindex="-1"></a>fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-215"><a href="#cb59-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"rate"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">FALSE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-216"><a href="#cb59-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">deviance =</span> <span class="fu">map2_dbl</span>(fit, exclude_sp1, <span class="cf">function</span>(x, y) {</span>
<span id="cb59-217"><a href="#cb59-217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">overall_deviance</span>(x<span class="sc">$</span>par, exp1_data_agg, <span class="at">exclude_sp1 =</span> y)</span>
<span id="cb59-218"><a href="#cb59-218" aria-hidden="true" tabindex="-1"></a>  })) <span class="sc">|&gt;</span></span>
<span id="cb59-219"><a href="#cb59-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence) <span class="sc">|&gt;</span></span>
<span id="cb59-220"><a href="#cb59-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-221"><a href="#cb59-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-222"><a href="#cb59-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-223"><a href="#cb59-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-224"><a href="#cb59-224" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-225"><a href="#cb59-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"rate"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">FALSE</span>, exp <span class="sc">==</span> <span class="dv">1</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-226"><a href="#cb59-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-227"><a href="#cb59-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"fit"</span>, <span class="dv">1</span>)</span>
<span id="cb59-228"><a href="#cb59-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-229"><a href="#cb59-229" aria-hidden="true" tabindex="-1"></a>exp1_data_agg<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, exp1_data_agg, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>))</span>
<span id="cb59-230"><a href="#cb59-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-231"><a href="#cb59-231" aria-hidden="true" tabindex="-1"></a>exp1_data_agg <span class="sc">|&gt;</span></span>
<span id="cb59-232"><a href="#cb59-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-233"><a href="#cb59-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-234"><a href="#cb59-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-235"><a href="#cb59-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb59-236"><a href="#cb59-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-237"><a href="#cb59-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-238"><a href="#cb59-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-239"><a href="#cb59-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-240"><a href="#cb59-240" aria-hidden="true" tabindex="-1"></a><span class="fu">## Repeat for expereiment 2</span></span>
<span id="cb59-241"><a href="#cb59-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-242"><a href="#cb59-242" aria-hidden="true" tabindex="-1"></a>Basic estimation (ignoring first chunk):</span>
<span id="cb59-243"><a href="#cb59-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-246"><a href="#cb59-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-247"><a href="#cb59-247" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(exp2_data_agg)</span>
<span id="cb59-248"><a href="#cb59-248" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">paper_params</span>(<span class="at">exp =</span> <span class="dv">2</span>)</span>
<span id="cb59-249"><a href="#cb59-249" aria-hidden="true" tabindex="-1"></a>(est <span class="ot">&lt;-</span> <span class="fu">estimate_model</span>(start, <span class="at">data =</span> exp2_data_agg, <span class="at">exclude_sp1 =</span> <span class="cn">TRUE</span>))</span>
<span id="cb59-250"><a href="#cb59-250" aria-hidden="true" tabindex="-1"></a>exp2_data_agg<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(est, exp2_data_agg, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>))</span>
<span id="cb59-251"><a href="#cb59-251" aria-hidden="true" tabindex="-1"></a>exp2_data_agg <span class="sc">|&gt;</span></span>
<span id="cb59-252"><a href="#cb59-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-253"><a href="#cb59-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-254"><a href="#cb59-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-255"><a href="#cb59-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb59-256"><a href="#cb59-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-257"><a href="#cb59-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-258"><a href="#cb59-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-259"><a href="#cb59-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-260"><a href="#cb59-260" aria-hidden="true" tabindex="-1"></a>again parameter estimates are different from the paper.</span>
<span id="cb59-261"><a href="#cb59-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-262"><a href="#cb59-262" aria-hidden="true" tabindex="-1"></a>Here are from multiple starting values:</span>
<span id="cb59-263"><a href="#cb59-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-266"><a href="#cb59-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-267"><a href="#cb59-267" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-268"><a href="#cb59-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"none"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">2</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-269"><a href="#cb59-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence, fit, data) <span class="sc">|&gt;</span></span>
<span id="cb59-270"><a href="#cb59-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-271"><a href="#cb59-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-272"><a href="#cb59-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-273"><a href="#cb59-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-274"><a href="#cb59-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-275"><a href="#cb59-275" aria-hidden="true" tabindex="-1"></a><span class="fu">### Problem with parameter identifiability</span></span>
<span id="cb59-276"><a href="#cb59-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-277"><a href="#cb59-277" aria-hidden="true" tabindex="-1"></a>rows 12-16 illustrate the problem with parameter identifiability quite well. They have nearly identical deviance, but very different parameters.</span>
<span id="cb59-278"><a href="#cb59-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-281"><a href="#cb59-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-282"><a href="#cb59-282" aria-hidden="true" tabindex="-1"></a>(fits <span class="ot">&lt;-</span> fits[<span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">16</span>), ])</span>
<span id="cb59-283"><a href="#cb59-283" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(fits, "output/five_parsets_exp2.rds")</span></span>
<span id="cb59-284"><a href="#cb59-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-285"><a href="#cb59-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-286"><a href="#cb59-286" aria-hidden="true" tabindex="-1"></a>Plot the predictions all 5 sets of parameters:</span>
<span id="cb59-287"><a href="#cb59-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-290"><a href="#cb59-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-291"><a href="#cb59-291" aria-hidden="true" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb59-292"><a href="#cb59-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">map2</span>(fit, data, \(x, y) <span class="fu">predict</span>(x, y, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb59-293"><a href="#cb59-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data, pred)) <span class="sc">|&gt;</span></span>
<span id="cb59-294"><a href="#cb59-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-295"><a href="#cb59-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-296"><a href="#cb59-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">linetype =</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(prop, <span class="dv">3</span>)))) <span class="sc">+</span></span>
<span id="cb59-297"><a href="#cb59-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-298"><a href="#cb59-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-299"><a href="#cb59-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-300"><a href="#cb59-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-301"><a href="#cb59-301" aria-hidden="true" tabindex="-1"></a>The way parameters change suggest that increasing prop can be compensated by increasing rate, taun and decreasing gain. Here's a pair plot of these parameters</span>
<span id="cb59-302"><a href="#cb59-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-305"><a href="#cb59-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-306"><a href="#cb59-306" aria-hidden="true" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb59-307"><a href="#cb59-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop, rate, tau, gain) <span class="sc">|&gt;</span></span>
<span id="cb59-308"><a href="#cb59-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpairs</span>(<span class="at">diag =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"blankDiag"</span>))</span>
<span id="cb59-309"><a href="#cb59-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-310"><a href="#cb59-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-311"><a href="#cb59-311" aria-hidden="true" tabindex="-1"></a>I'll investigate this in a separate notebook.</span>
<span id="cb59-312"><a href="#cb59-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-313"><a href="#cb59-313" aria-hidden="true" tabindex="-1"></a><span class="fu">### With prior on gain</span></span>
<span id="cb59-314"><a href="#cb59-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-317"><a href="#cb59-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-318"><a href="#cb59-318" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-319"><a href="#cb59-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"gain"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">2</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-320"><a href="#cb59-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">deviance =</span> <span class="fu">map2_dbl</span>(fit, exclude_sp1, <span class="cf">function</span>(x, y) {</span>
<span id="cb59-321"><a href="#cb59-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">overall_deviance</span>(x<span class="sc">$</span>par, exp2_data_agg, <span class="at">exclude_sp1 =</span> y)</span>
<span id="cb59-322"><a href="#cb59-322" aria-hidden="true" tabindex="-1"></a>  })) <span class="sc">|&gt;</span></span>
<span id="cb59-323"><a href="#cb59-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence, fit, data) <span class="sc">|&gt;</span></span>
<span id="cb59-324"><a href="#cb59-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-325"><a href="#cb59-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-326"><a href="#cb59-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-327"><a href="#cb59-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-328"><a href="#cb59-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-329"><a href="#cb59-329" aria-hidden="true" tabindex="-1"></a>I see three sets of parameters that are close in deviance (relatively):</span>
<span id="cb59-330"><a href="#cb59-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-333"><a href="#cb59-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-334"><a href="#cb59-334" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> fit[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">11</span>, <span class="dv">13</span>), ]</span>
<span id="cb59-335"><a href="#cb59-335" aria-hidden="true" tabindex="-1"></a>fits</span>
<span id="cb59-336"><a href="#cb59-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-337"><a href="#cb59-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-338"><a href="#cb59-338" aria-hidden="true" tabindex="-1"></a>plots</span>
<span id="cb59-339"><a href="#cb59-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-342"><a href="#cb59-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-343"><a href="#cb59-343" aria-hidden="true" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb59-344"><a href="#cb59-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">map2</span>(fit, data, \(x, y) <span class="fu">predict</span>(x, y, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb59-345"><a href="#cb59-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data, pred)) <span class="sc">|&gt;</span></span>
<span id="cb59-346"><a href="#cb59-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-347"><a href="#cb59-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-348"><a href="#cb59-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">linetype =</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(prop, <span class="dv">3</span>)))) <span class="sc">+</span></span>
<span id="cb59-349"><a href="#cb59-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-350"><a href="#cb59-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-351"><a href="#cb59-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-352"><a href="#cb59-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-353"><a href="#cb59-353" aria-hidden="true" tabindex="-1"></a>this case is particularly interesting. The bestfitting parameters produce almost no interaction. The other two sets of parameters produce a strong interaction, but misfit the overall data. </span>
<span id="cb59-354"><a href="#cb59-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-355"><a href="#cb59-355" aria-hidden="true" tabindex="-1"></a>Further, the parameter set with rate 0.024 and 0.271 have quite similar fits despite very different parameter sets!</span>
<span id="cb59-356"><a href="#cb59-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-357"><a href="#cb59-357" aria-hidden="true" tabindex="-1"></a><span class="fu">### with prior on rate</span></span>
<span id="cb59-358"><a href="#cb59-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-361"><a href="#cb59-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-362"><a href="#cb59-362" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-363"><a href="#cb59-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"rate"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">TRUE</span>, exp <span class="sc">==</span> <span class="dv">2</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-364"><a href="#cb59-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">deviance =</span> <span class="fu">map2_dbl</span>(fit, exclude_sp1, <span class="cf">function</span>(x, y) {</span>
<span id="cb59-365"><a href="#cb59-365" aria-hidden="true" tabindex="-1"></a>    <span class="fu">overall_deviance</span>(x<span class="sc">$</span>par, exp2_data_agg, <span class="at">exclude_sp1 =</span> y)</span>
<span id="cb59-366"><a href="#cb59-366" aria-hidden="true" tabindex="-1"></a>  })) <span class="sc">|&gt;</span></span>
<span id="cb59-367"><a href="#cb59-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence, fit, data) <span class="sc">|&gt;</span></span>
<span id="cb59-368"><a href="#cb59-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-369"><a href="#cb59-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-370"><a href="#cb59-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span>
<span id="cb59-371"><a href="#cb59-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-372"><a href="#cb59-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-373"><a href="#cb59-373" aria-hidden="true" tabindex="-1"></a>plots</span>
<span id="cb59-374"><a href="#cb59-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-377"><a href="#cb59-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-378"><a href="#cb59-378" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> fit[<span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">43</span>), ] <span class="co"># previous 83</span></span>
<span id="cb59-379"><a href="#cb59-379" aria-hidden="true" tabindex="-1"></a>fits</span>
<span id="cb59-380"><a href="#cb59-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-381"><a href="#cb59-381" aria-hidden="true" tabindex="-1"></a>fits <span class="sc">|&gt;</span></span>
<span id="cb59-382"><a href="#cb59-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">map2</span>(fit, data, \(x, y) <span class="fu">predict</span>(x, y, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb59-383"><a href="#cb59-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data, pred)) <span class="sc">|&gt;</span></span>
<span id="cb59-384"><a href="#cb59-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-385"><a href="#cb59-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-386"><a href="#cb59-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">linetype =</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(prop, <span class="dv">3</span>)))) <span class="sc">+</span></span>
<span id="cb59-387"><a href="#cb59-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-388"><a href="#cb59-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-389"><a href="#cb59-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-390"><a href="#cb59-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-391"><a href="#cb59-391" aria-hidden="true" tabindex="-1"></a><span class="fu">### Including the first chunk in the optimization</span></span>
<span id="cb59-392"><a href="#cb59-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-395"><a href="#cb59-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-396"><a href="#cb59-396" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">paper_params</span>(<span class="at">exp =</span> <span class="dv">2</span>)</span>
<span id="cb59-397"><a href="#cb59-397" aria-hidden="true" tabindex="-1"></a>(est <span class="ot">&lt;-</span> <span class="fu">estimate_model</span>(start, <span class="at">data =</span> exp2_data_agg, <span class="at">exclude_sp1 =</span> <span class="cn">FALSE</span>))</span>
<span id="cb59-398"><a href="#cb59-398" aria-hidden="true" tabindex="-1"></a>exp2_data_agg<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(est, exp2_data_agg, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>))</span>
<span id="cb59-399"><a href="#cb59-399" aria-hidden="true" tabindex="-1"></a>exp2_data_agg <span class="sc">|&gt;</span></span>
<span id="cb59-400"><a href="#cb59-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-401"><a href="#cb59-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-402"><a href="#cb59-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-403"><a href="#cb59-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb59-404"><a href="#cb59-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-405"><a href="#cb59-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-406"><a href="#cb59-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-407"><a href="#cb59-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-408"><a href="#cb59-408" aria-hidden="true" tabindex="-1"></a>from multiple starting values:</span>
<span id="cb59-409"><a href="#cb59-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-412"><a href="#cb59-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-413"><a href="#cb59-413" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-414"><a href="#cb59-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"none"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">FALSE</span>, exp <span class="sc">==</span> <span class="dv">2</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-415"><a href="#cb59-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence, fit, data) <span class="sc">|&gt;</span></span>
<span id="cb59-416"><a href="#cb59-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-417"><a href="#cb59-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb59-418"><a href="#cb59-418" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fits)</span>
<span id="cb59-419"><a href="#cb59-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-420"><a href="#cb59-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-421"><a href="#cb59-421" aria-hidden="true" tabindex="-1"></a><span class="fu">### With prior on rate</span></span>
<span id="cb59-422"><a href="#cb59-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-425"><a href="#cb59-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-426"><a href="#cb59-426" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-427"><a href="#cb59-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(priors_scenario <span class="sc">==</span> <span class="st">"rate"</span>, exclude_sp1 <span class="sc">==</span> <span class="cn">FALSE</span>, exp <span class="sc">==</span> <span class="dv">2</span>, convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-428"><a href="#cb59-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">deviance =</span> <span class="fu">map2_dbl</span>(fit, exclude_sp1, <span class="cf">function</span>(x, y) {</span>
<span id="cb59-429"><a href="#cb59-429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">overall_deviance</span>(x<span class="sc">$</span>par, exp2_data_agg, <span class="at">exclude_sp1 =</span> y)</span>
<span id="cb59-430"><a href="#cb59-430" aria-hidden="true" tabindex="-1"></a>  })) <span class="sc">|&gt;</span></span>
<span id="cb59-431"><a href="#cb59-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prop<span class="sc">:</span>convergence, fit, data) <span class="sc">|&gt;</span></span>
<span id="cb59-432"><a href="#cb59-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-433"><a href="#cb59-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb59-434"><a href="#cb59-434" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fit)</span>
<span id="cb59-435"><a href="#cb59-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-436"><a href="#cb59-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-437"><a href="#cb59-437" aria-hidden="true" tabindex="-1"></a>plot predictions</span>
<span id="cb59-438"><a href="#cb59-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-441"><a href="#cb59-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-442"><a href="#cb59-442" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb59-443"><a href="#cb59-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-444"><a href="#cb59-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">map2</span>(fit, data, \(x, y) <span class="fu">predict</span>(x, y, <span class="at">group_by =</span> <span class="fu">c</span>(<span class="st">"chunk"</span>, <span class="st">"gap"</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb59-445"><a href="#cb59-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data, pred)) <span class="sc">|&gt;</span></span>
<span id="cb59-446"><a href="#cb59-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-447"><a href="#cb59-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-448"><a href="#cb59-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">linetype =</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(prop, <span class="dv">3</span>)))) <span class="sc">+</span></span>
<span id="cb59-449"><a href="#cb59-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"First chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-450"><a href="#cb59-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>itemtype)</span>
<span id="cb59-451"><a href="#cb59-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-452"><a href="#cb59-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-453"><a href="#cb59-453" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb59-454"><a href="#cb59-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-455"><a href="#cb59-455" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The parameters reported in the paper are not the best fitting</span>
<span id="cb59-456"><a href="#cb59-456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When I start from 100 different starting values, I get better fitting parameters, but with an even lower <span class="in">`rate`</span></span>
<span id="cb59-457"><a href="#cb59-457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>I can reproduce the parameters from the paper if I fix the gain parameter to 25</span>
<span id="cb59-458"><a href="#cb59-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-459"><a href="#cb59-459" aria-hidden="true" tabindex="-1"></a><span class="fu">### Best fitting parameters</span></span>
<span id="cb59-460"><a href="#cb59-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-461"><a href="#cb59-461" aria-hidden="true" tabindex="-1"></a>Given the different modeling choices (ignoring the first chunk or not, priors on the parameters)</span>
<span id="cb59-462"><a href="#cb59-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-463"><a href="#cb59-463" aria-hidden="true" tabindex="-1"></a>TODO: make this into a function for getting the final parameters</span>
<span id="cb59-464"><a href="#cb59-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-467"><a href="#cb59-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-468"><a href="#cb59-468" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: best-params</span></span>
<span id="cb59-469"><a href="#cb59-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-470"><a href="#cb59-470" aria-hidden="true" tabindex="-1"></a>final <span class="ot">&lt;-</span> fits1 <span class="sc">|&gt;</span></span>
<span id="cb59-471"><a href="#cb59-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(convergence <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-472"><a href="#cb59-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(exp, priors_scenario, exclude_sp1) <span class="sc">|&gt;</span></span>
<span id="cb59-473"><a href="#cb59-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-474"><a href="#cb59-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-475"><a href="#cb59-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(exclude_sp1), exp, priors_scenario) <span class="sc">|&gt;</span></span>
<span id="cb59-476"><a href="#cb59-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb59-477"><a href="#cb59-477" aria-hidden="true" tabindex="-1"></a>    <span class="at">deviance =</span> <span class="fu">round</span>(deviance, <span class="dv">1</span>),</span>
<span id="cb59-478"><a href="#cb59-478" aria-hidden="true" tabindex="-1"></a>    <span class="at">priors_scenario =</span> <span class="fu">case_when</span>(</span>
<span id="cb59-479"><a href="#cb59-479" aria-hidden="true" tabindex="-1"></a>      priors_scenario <span class="sc">==</span> <span class="st">"none"</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb59-480"><a href="#cb59-480" aria-hidden="true" tabindex="-1"></a>      priors_scenario <span class="sc">==</span> <span class="st">"gain"</span> <span class="sc">~</span> <span class="st">"Gain ~ N(25, 0.1)"</span>,</span>
<span id="cb59-481"><a href="#cb59-481" aria-hidden="true" tabindex="-1"></a>      priors_scenario <span class="sc">==</span> <span class="st">"rate"</span> <span class="sc">~</span> <span class="st">"Rate ~ N(0.1, 0.01)"</span></span>
<span id="cb59-482"><a href="#cb59-482" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-483"><a href="#cb59-483" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-484"><a href="#cb59-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-485"><a href="#cb59-485" aria-hidden="true" tabindex="-1"></a>final <span class="sc">|&gt;</span></span>
<span id="cb59-486"><a href="#cb59-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(exp, priors_scenario, exclude_sp1, prop<span class="sc">:</span>gain, deviance) <span class="sc">|&gt;</span></span>
<span id="cb59-487"><a href="#cb59-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(round, <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-488"><a href="#cb59-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb59-489"><a href="#cb59-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb59-490"><a href="#cb59-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-491"><a href="#cb59-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-492"><a href="#cb59-492" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>prop_ltm very different between the two experiments (overfitting...)</span>
<span id="cb59-493"><a href="#cb59-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-494"><a href="#cb59-494" aria-hidden="true" tabindex="-1"></a><span class="fu">### Predictions</span></span>
<span id="cb59-495"><a href="#cb59-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-496"><a href="#cb59-496" aria-hidden="true" tabindex="-1"></a>(the two experiments are modeled separately)</span>
<span id="cb59-497"><a href="#cb59-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-498"><a href="#cb59-498" aria-hidden="true" tabindex="-1"></a><span class="fu">### All predictions</span></span>
<span id="cb59-499"><a href="#cb59-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-502"><a href="#cb59-502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-503"><a href="#cb59-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 8.5</span></span>
<span id="cb59-504"><a href="#cb59-504" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb59-505"><a href="#cb59-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-506"><a href="#cb59-506" aria-hidden="true" tabindex="-1"></a>final <span class="sc">|&gt;</span></span>
<span id="cb59-507"><a href="#cb59-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(exp, rate, data, pred) <span class="sc">|&gt;</span></span>
<span id="cb59-508"><a href="#cb59-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exp =</span> <span class="fu">paste0</span>(<span class="st">"Exp "</span>, exp)) <span class="sc">|&gt;</span></span>
<span id="cb59-509"><a href="#cb59-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data, pred)) <span class="sc">|&gt;</span></span>
<span id="cb59-510"><a href="#cb59-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-511"><a href="#cb59-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-512"><a href="#cb59-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">linetype =</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(rate, <span class="dv">3</span>)))) <span class="sc">+</span></span>
<span id="cb59-513"><a href="#cb59-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"1st chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-514"><a href="#cb59-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Rate"</span>) <span class="sc">+</span></span>
<span id="cb59-515"><a href="#cb59-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(exp <span class="sc">~</span> itemtype) <span class="sc">+</span></span>
<span id="cb59-516"><a href="#cb59-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pub</span>()</span>
<span id="cb59-517"><a href="#cb59-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-518"><a href="#cb59-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-519"><a href="#cb59-519" aria-hidden="true" tabindex="-1"></a><span class="fu">### Experiment 1</span></span>
<span id="cb59-520"><a href="#cb59-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-523"><a href="#cb59-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-524"><a href="#cb59-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 8.5</span></span>
<span id="cb59-525"><a href="#cb59-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 12</span></span>
<span id="cb59-526"><a href="#cb59-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-527"><a href="#cb59-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-528"><a href="#cb59-528" aria-hidden="true" tabindex="-1"></a>final <span class="sc">|&gt;</span></span>
<span id="cb59-529"><a href="#cb59-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exp <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-530"><a href="#cb59-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(rate) <span class="sc">|&gt;</span></span>
<span id="cb59-531"><a href="#cb59-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rate, data, pred) <span class="sc">|&gt;</span></span>
<span id="cb59-532"><a href="#cb59-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data, pred)) <span class="sc">|&gt;</span></span>
<span id="cb59-533"><a href="#cb59-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> <span class="fu">as.character</span>(<span class="fu">round</span>(rate, <span class="dv">4</span>))) <span class="sc">|&gt;</span></span>
<span id="cb59-534"><a href="#cb59-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-535"><a href="#cb59-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-536"><a href="#cb59-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">linetype =</span> )) <span class="sc">+</span></span>
<span id="cb59-537"><a href="#cb59-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"1st chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-538"><a href="#cb59-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Rate"</span>) <span class="sc">+</span></span>
<span id="cb59-539"><a href="#cb59-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(rate <span class="sc">~</span> itemtype) <span class="sc">+</span></span>
<span id="cb59-540"><a href="#cb59-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pub</span>()</span>
<span id="cb59-541"><a href="#cb59-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-542"><a href="#cb59-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-543"><a href="#cb59-543" aria-hidden="true" tabindex="-1"></a><span class="fu">### Experiment 2</span></span>
<span id="cb59-544"><a href="#cb59-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-547"><a href="#cb59-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-548"><a href="#cb59-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 8.5</span></span>
<span id="cb59-549"><a href="#cb59-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 12</span></span>
<span id="cb59-550"><a href="#cb59-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-551"><a href="#cb59-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-552"><a href="#cb59-552" aria-hidden="true" tabindex="-1"></a>final <span class="sc">|&gt;</span></span>
<span id="cb59-553"><a href="#cb59-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exp <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-554"><a href="#cb59-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(rate) <span class="sc">|&gt;</span></span>
<span id="cb59-555"><a href="#cb59-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rate, data, pred) <span class="sc">|&gt;</span></span>
<span id="cb59-556"><a href="#cb59-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(data, pred)) <span class="sc">|&gt;</span></span>
<span id="cb59-557"><a href="#cb59-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate =</span> <span class="fu">as.character</span>(<span class="fu">round</span>(rate, <span class="dv">4</span>))) <span class="sc">|&gt;</span></span>
<span id="cb59-558"><a href="#cb59-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gap, <span class="at">y =</span> p_correct, <span class="at">color =</span> chunk)) <span class="sc">+</span></span>
<span id="cb59-559"><a href="#cb59-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-560"><a href="#cb59-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred, <span class="at">linetype =</span> )) <span class="sc">+</span></span>
<span id="cb59-561"><a href="#cb59-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="st">"1st chunk LTM?"</span>) <span class="sc">+</span></span>
<span id="cb59-562"><a href="#cb59-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_discrete</span>(<span class="st">"Rate"</span>) <span class="sc">+</span></span>
<span id="cb59-563"><a href="#cb59-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(rate <span class="sc">~</span> itemtype) <span class="sc">+</span></span>
<span id="cb59-564"><a href="#cb59-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pub</span>()</span>
<span id="cb59-565"><a href="#cb59-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>